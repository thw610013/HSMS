var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,u=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{s as d,_ as o,d as i,e as c}from"./index-22381d63.js";import{a9 as n,al as p,Q as m,O as f,P as h,ab as b,ac as g,R as v,aj as _,ak as y,an as V,ao as w,ap as N,aq as I,af as k,ag as O,ad as j,ae as C,ah as U,as as z}from"./element-plus-e2333c73.js";import{M as q,r as x,f as P,m as S,E as T,z as R,D as A,a4 as D,l as E,q as F,A as M,y as Q,F as W,W as $}from"./vue-core-9ee4ed8b.js";import"./icons-c547ea56.js";import"./utils-e59f4bae.js";const B={class:"course-offering-container"},G={class:"card-header"},H={class:"header-buttons"},J={class:"pagination-container"},K={class:"form-buttons"},L=o({__name:"index",setup(e){const o=q({courseName:"",teacherName:"",semester:"",pageNum:1,pageSize:10}),L=x([]),X=x(0),Y=x(!1),Z=x([]),ee=x([]),ae=q({visible:!1,title:"新增课程开设",type:"add"}),le=q({id:null,courseId:null,teacherId:null,semester:"",classTime:"",location:"",capacity:30,status:0}),te={courseId:[{required:!0,message:"请选择课程",trigger:"change"}],teacherId:[{required:!0,message:"请选择教师",trigger:"change"}],semester:[{required:!0,message:"请输入学期",trigger:"blur"}],classTime:[{required:!0,message:"请输入上课时间",trigger:"blur"}],location:[{required:!0,message:"请输入上课地点",trigger:"blur"}],capacity:[{required:!0,message:"请输入容量",trigger:"blur"}]},re=x(null);function se(){var e;Y.value=!0,(e=o,d({url:"/courseOffering/list",method:"get",params:e}).catch((e=>{throw e}))).then((e=>{L.value=e.data.list,X.value=e.data.total})).finally((()=>Y.value=!1))}function ue(){o.pageNum=1,se()}function de(){o.courseName="",o.teacherName="",o.semester="",ue()}function oe(e){o.pageSize=e,se()}function ie(e){o.pageNum=e,se()}function ce(e,a){ae.type=e,ae.title="add"===e?"新增课程开设":"编辑课程开设",ae.visible=!0,"edit"===e&&a?Object.assign(le,a):Object.assign(le,{id:null,courseId:null,teacherId:null,semester:"",classTime:"",location:"",capacity:30,status:0})}function ne(){re.value.validate((e=>{if(!e)return;const o=(i=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&u(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&u(e,l,a[l]);return e})({},le),c={courseId:Number(le.courseId),teacherId:Number(le.teacherId),capacity:Number(le.capacity),status:Number(le.status)},a(i,l(c)));var i,c,n;"add"===ae.type?(n=o,d({url:"/courseOffering",method:"post",data:n}).catch((e=>{throw e}))).then((e=>{f.success("新增成功"),ae.visible=!1,se()})).catch((e=>{f.error(e.message||"新增失败，请检查表单数据")})):function(e){return d({url:"/courseOffering",method:"put",data:e}).catch((e=>{throw e}))}(o).then((e=>{f.success("修改成功"),ae.visible=!1,se()})).catch((e=>{f.error(e.message||"修改失败，请检查表单数据")}))}))}function pe(e){h.confirm("确定要删除该课程开设记录吗？","提示",{type:"warning"}).then((()=>{var a;(a=e.id,d({url:`/courseOffering/${a}`,method:"delete"}).catch((e=>{throw e}))).then((()=>{f.success("删除成功"),se()}))}))}return P((()=>{se(),i().then((e=>{200===e.code&&e.data&&e.data.list?Z.value=e.data.list.map((e=>({id:e.id,name:e.name}))):Z.value=[]})).catch((e=>{Z.value=[]})),c().then((e=>{200===e.code&&e.data&&e.data.list?ee.value=e.data.list.map((e=>({id:e.id,name:e.name||(e.user?e.user.name:"未知教师")}))):ee.value=[]})).catch((e=>{ee.value=[]}))})),(e,a)=>{const l=b,t=g,r=D("Search"),s=v,u=_,d=D("Refresh"),i=y,c=n,f=D("Plus"),h=V,q=w,x=N,P=I,se=k,me=O,fe=j,he=C,be=U,ge=p,ve=z;return E(),S("div",B,[T(c,{class:"search-card",shadow:"hover"},{default:R((()=>[T(i,{model:o,ref:"queryForm",inline:!0},{default:R((()=>[T(t,{label:"课程名称",prop:"courseName"},{default:R((()=>[T(l,{modelValue:o.courseName,"onUpdate:modelValue":a[0]||(a[0]=e=>o.courseName=e),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])])),_:1}),a[18]||(a[18]=A()),T(t,{label:"教师名称",prop:"teacherName"},{default:R((()=>[T(l,{modelValue:o.teacherName,"onUpdate:modelValue":a[1]||(a[1]=e=>o.teacherName=e),placeholder:"请输入教师名称",clearable:""},null,8,["modelValue"])])),_:1}),a[19]||(a[19]=A()),T(t,{label:"学期",prop:"semester"},{default:R((()=>[T(l,{modelValue:o.semester,"onUpdate:modelValue":a[2]||(a[2]=e=>o.semester=e),placeholder:"请输入学期",clearable:""},null,8,["modelValue"])])),_:1}),a[20]||(a[20]=A()),T(t,null,{default:R((()=>[T(u,{type:"primary",onClick:ue},{default:R((()=>[T(s,null,{default:R((()=>[T(r)])),_:1}),a[15]||(a[15]=A("查询\n          "))])),_:1}),a[17]||(a[17]=A()),T(u,{onClick:de},{default:R((()=>[T(s,null,{default:R((()=>[T(d)])),_:1}),a[16]||(a[16]=A("重置\n          "))])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),a[49]||(a[49]=A()),T(c,{class:"table-card",shadow:"hover"},{header:R((()=>[F("div",G,[a[22]||(a[22]=F("span",{class:"header-title"},"课程开设记录",-1)),a[23]||(a[23]=A()),F("div",H,[T(u,{type:"primary",onClick:a[3]||(a[3]=e=>ce("add"))},{default:R((()=>[T(s,null,{default:R((()=>[T(f)])),_:1}),a[21]||(a[21]=A("新增\n            "))])),_:1})])])])),default:R((()=>[a[36]||(a[36]=A()),M((E(),Q(x,{data:L.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f5f7fa",color:"#606266"}},{default:R((()=>[T(h,{type:"index",label:"#",width:"60"}),a[27]||(a[27]=A()),T(h,{prop:"courseName",label:"课程名称",width:"160"}),a[28]||(a[28]=A()),T(h,{prop:"teacherName",label:"教师名称",width:"120"}),a[29]||(a[29]=A()),T(h,{prop:"semester",label:"学期",width:"120"}),a[30]||(a[30]=A()),T(h,{prop:"classTime",label:"上课时间",width:"120"}),a[31]||(a[31]=A()),T(h,{prop:"location",label:"上课地点",width:"120"}),a[32]||(a[32]=A()),T(h,{prop:"capacity",label:"容量",width:"80",align:"center"}),a[33]||(a[33]=A()),T(h,{prop:"selectedCount",label:"已选人数",width:"100",align:"center"}),a[34]||(a[34]=A()),T(h,{label:"状态",width:"100",align:"center"},{default:R((e=>[T(q,{type:0===e.row.status?"success":"info"},{default:R((()=>[A(m(0===e.row.status?"正常":"已结课"),1)])),_:2},1032,["type"])])),_:1}),a[35]||(a[35]=A()),T(h,{label:"操作","min-width":"180",fixed:"right"},{default:R((e=>[T(u,{type:"primary",link:"",onClick:a=>ce("edit",e.row)},{default:R((()=>a[24]||(a[24]=[A("编辑")]))),_:2},1032,["onClick"]),a[26]||(a[26]=A()),T(u,{type:"danger",link:"",onClick:a=>pe(e.row)},{default:R((()=>a[25]||(a[25]=[A("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ve,Y.value]]),a[37]||(a[37]=A()),F("div",J,[T(P,{"current-page":o.pageNum,"onUpdate:currentPage":a[4]||(a[4]=e=>o.pageNum=e),"page-size":o.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>o.pageSize=e),"page-sizes":[10,20,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:X.value,onSizeChange:oe,onCurrentChange:ie},null,8,["current-page","page-size","total"])])])),_:1}),a[50]||(a[50]=A()),T(ge,{title:ae.title,modelValue:ae.visible,"onUpdate:modelValue":a[14]||(a[14]=e=>ae.visible=e),width:"600px","append-to-body":"","destroy-on-close":""},{default:R((()=>[T(i,{ref_key:"formRef",ref:re,model:le,rules:te,"label-width":"100px"},{default:R((()=>[T(be,{gutter:24},{default:R((()=>[T(fe,{span:12},{default:R((()=>[T(t,{label:"课程",prop:"courseId"},{default:R((()=>[T(me,{modelValue:le.courseId,"onUpdate:modelValue":a[6]||(a[6]=e=>le.courseId=e),placeholder:"请选择课程",filterable:""},{default:R((()=>[(E(!0),S(W,null,$(Z.value,(e=>(E(),Q(se,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),a[39]||(a[39]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"教师",prop:"teacherId"},{default:R((()=>[T(me,{modelValue:le.teacherId,"onUpdate:modelValue":a[7]||(a[7]=e=>le.teacherId=e),placeholder:"请选择教师",filterable:""},{default:R((()=>[(E(!0),S(W,null,$(ee.value,(e=>(E(),Q(se,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),a[40]||(a[40]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"学期",prop:"semester"},{default:R((()=>[T(l,{modelValue:le.semester,"onUpdate:modelValue":a[8]||(a[8]=e=>le.semester=e),placeholder:"如 2023-2024-1"},null,8,["modelValue"])])),_:1})])),_:1}),a[41]||(a[41]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"上课时间",prop:"classTime"},{default:R((()=>[T(l,{modelValue:le.classTime,"onUpdate:modelValue":a[9]||(a[9]=e=>le.classTime=e),placeholder:"如 周一 1-2节"},null,8,["modelValue"])])),_:1})])),_:1}),a[42]||(a[42]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"上课地点",prop:"location"},{default:R((()=>[T(l,{modelValue:le.location,"onUpdate:modelValue":a[10]||(a[10]=e=>le.location=e),placeholder:"如 教学楼A-101"},null,8,["modelValue"])])),_:1})])),_:1}),a[43]||(a[43]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"容量",prop:"capacity"},{default:R((()=>[T(he,{modelValue:le.capacity,"onUpdate:modelValue":a[11]||(a[11]=e=>le.capacity=e),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),a[44]||(a[44]=A()),T(fe,{span:12},{default:R((()=>[T(t,{label:"状态",prop:"status"},{default:R((()=>[T(me,{modelValue:le.status,"onUpdate:modelValue":a[12]||(a[12]=e=>le.status=e),placeholder:"请选择状态"},{default:R((()=>[T(se,{label:"正常",value:0}),a[38]||(a[38]=A()),T(se,{label:"已结课",value:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),a[48]||(a[48]=A()),F("div",K,[T(u,{onClick:a[13]||(a[13]=e=>ae.visible=!1)},{default:R((()=>a[45]||(a[45]=[A("取消")]))),_:1}),a[47]||(a[47]=A()),T(u,{type:"primary",onClick:ne},{default:R((()=>a[46]||(a[46]=[A("确定")]))),_:1})])])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}},[["__scopeId","data-v-8104f71c"]]);export{L as default};
