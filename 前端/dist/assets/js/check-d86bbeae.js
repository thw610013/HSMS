var e=(e,a,l)=>new Promise(((t,s)=>{var u=e=>{try{o(l.next(e))}catch(a){s(a)}},r=e=>{try{o(l.throw(e))}catch(a){s(a)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,r);o((l=l.apply(e,a)).next())}));import{s as a,u as l,_ as t}from"./index-22381d63.js";import{M as s,R as u,T as r}from"./icons-c547ea56.js";import{l as o}from"./manage-35282360.js";import{O as n,a9 as d,ah as c,al as i,Q as m,p,P as f,ag as v,ac as b,ab as g,R as _,aj as h,ak as y,ad as N,an as w,ao as V,ap as x,aq as k,az as C,aA as z,as as j,af as U}from"./element-plus-e2333c73.js";import{r as T,M as R,f as D,m as P,E as B,z as F,D as L,l as S,q as O,F as q,W as A,u as E,y as M,C as $,A as I}from"./vue-core-9ee4ed8b.js";import"./utils-e59f4bae.js";function Q(e){if(""!==e&&null!=e)return e}function W(e){if(!e||0===e.length)return!0;const a=l().roles;return!(!a||0===a.length)&&a.some((a=>e.includes(a)))}const G={class:"app-container"},H={class:"search-form-container"},J={class:"form-row"},K={class:"dialog-footer"},X=t({__name:"check",setup(l){const t=[{value:0,label:"已选"},{value:1,label:"已退"},{value:2,label:"已修完"}],X=T([]),Y=R({pageNum:1,pageSize:10,studentNo:"",studentName:"",courseName:"",semester:"",status:void 0}),Z=T([]),ee=T(!1),ae=T(0),le=T(!1),te=T({});D((()=>{se(),ue()}));const se=()=>e(this,null,(function*(){try{const e=yield o();200===e.code&&(X.value=e.data.map((e=>({value:e.value,label:e.label}))))}catch(e){n.error("获取学期选项失败")}})),ue=()=>e(this,null,(function*(){ee.value=!0;try{const l=yield(e=Y,a({url:"/selection/manage/list",method:"get",params:e}));200===l.code?(Z.value=l.data.list||[],ae.value=l.data.total):(n.error(l.msg||"获取数据失败"),Z.value=[],ae.value=0)}catch(l){n.error("获取列表数据失败"),Z.value=[],ae.value=0}finally{ee.value=!1}var e})),re=e=>0===e?"info":1===e?"danger":2===e?"success":"",oe=e=>null===e?"":e<60?"text-danger":e>=90?"text-success":"",ne=()=>{Y.pageNum=1,ue()},de=()=>{Y.studentNo="",Y.studentName="",Y.courseName="",Y.semester="",Y.status=void 0,ne()},ce=e=>{Y.pageSize=e,ue()},ie=e=>{Y.pageNum=e,ue()},me=l=>e(this,null,(function*(){try{const t=yield(e=l.id,a({url:`/selection/manage/${Q(e)}`,method:"get"}));200===t.code?(te.value=t.data,le.value=!0):n.error(t.msg||"获取详情失败")}catch(t){n.error("获取详情失败")}var e})),pe=()=>{f.confirm("是否确认导出所有成绩数据?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{var e;(e=Y,a({url:"/selection/manage/export",method:"get",params:e,responseType:"blob"})).then((e=>{const a=new Blob([e.data],{type:"application/vnd.ms-excel"}),l=`成绩数据_${(new Date).getTime()}.xlsx`,t=document.createElement("a");t.href=URL.createObjectURL(a),t.download=l,t.click(),URL.revokeObjectURL(t.href),n.success("导出成功")})).catch((e=>{n.error("导出失败")}))}))};return(e,a)=>{const l=U,o=v,n=b,f=g,T=_,R=h,D=y,Q=d,se=N,ue=c,fe=w,ve=V,be=x,ge=k,_e=C,he=z,ye=i,Ne=j;return S(),P("div",G,[B(Q,{class:"search-card"},{default:F((()=>[O("div",H,[B(D,{model:Y,ref:"searchForm",inline:!0,class:"search-form"},{default:F((()=>[O("div",J,[B(n,{label:"学期"},{default:F((()=>[B(o,{modelValue:Y.semester,"onUpdate:modelValue":a[0]||(a[0]=e=>Y.semester=e),placeholder:"选择学期",clearable:""},{default:F((()=>[(S(!0),P(q,null,A(X.value,(e=>(S(),M(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),a[10]||(a[10]=L()),B(n,{label:"学号"},{default:F((()=>[B(f,{modelValue:Y.studentNo,"onUpdate:modelValue":a[1]||(a[1]=e=>Y.studentNo=e),placeholder:"请输入学号",clearable:""},null,8,["modelValue"])])),_:1}),a[11]||(a[11]=L()),B(n,{label:"学生姓名"},{default:F((()=>[B(f,{modelValue:Y.studentName,"onUpdate:modelValue":a[2]||(a[2]=e=>Y.studentName=e),placeholder:"请输入学生姓名",clearable:""},null,8,["modelValue"])])),_:1}),a[12]||(a[12]=L()),B(n,{label:"课程名称"},{default:F((()=>[B(f,{modelValue:Y.courseName,"onUpdate:modelValue":a[3]||(a[3]=e=>Y.courseName=e),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])])),_:1}),a[13]||(a[13]=L()),B(n,{label:"状态"},{default:F((()=>[B(o,{modelValue:Y.status,"onUpdate:modelValue":a[4]||(a[4]=e=>Y.status=e),placeholder:"请选择状态",clearable:""},{default:F((()=>[(S(),P(q,null,A(t,(e=>B(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),a[14]||(a[14]=L()),B(n,null,{default:F((()=>[B(R,{type:"primary",onClick:ne},{default:F((()=>[B(T,null,{default:F((()=>[B(E(s))])),_:1}),a[7]||(a[7]=L("查询\r\n              "))])),_:1}),a[9]||(a[9]=L()),B(R,{onClick:de},{default:F((()=>[B(T,null,{default:F((()=>[B(E(u))])),_:1}),a[8]||(a[8]=L("重置\r\n              "))])),_:1})])),_:1})])])),_:1},8,["model"])])])),_:1}),a[40]||(a[40]=L()),B(ue,{gutter:10,class:"mb-2 mt-2"},{default:F((()=>[B(se,{span:1.5},{default:F((()=>[E(W)(["admin","teacher"])?(S(),M(R,{key:0,type:"primary",onClick:pe},{default:F((()=>[B(T,null,{default:F((()=>[B(E(r))])),_:1}),a[15]||(a[15]=L("导出\r\n        "))])),_:1})):$("",!0)])),_:1})])),_:1}),a[41]||(a[41]=L()),B(Q,null,{default:F((()=>[I((S(),M(be,{data:Z.value,stripe:"",border:"",style:{width:"100%"},"highlight-current-row":""},{default:F((()=>[B(fe,{type:"index",width:"55",align:"center",label:"序号"}),a[17]||(a[17]=L()),B(fe,{prop:"studentNo",label:"学号",align:"center"}),a[18]||(a[18]=L()),B(fe,{prop:"studentName",label:"学生姓名",align:"center"}),a[19]||(a[19]=L()),B(fe,{prop:"className",label:"班级",align:"center"}),a[20]||(a[20]=L()),B(fe,{prop:"courseCode",label:"课程代码",align:"center"}),a[21]||(a[21]=L()),B(fe,{prop:"courseName",label:"课程名称",align:"center"}),a[22]||(a[22]=L()),B(fe,{prop:"semester",label:"学期",align:"center"}),a[23]||(a[23]=L()),B(fe,{prop:"score",label:"成绩",align:"center"},{default:F((e=>[O("span",{class:p(oe(e.row.score)),style:{"font-weight":"bold"}},m(null!==e.row.score?e.row.score.toFixed(1):"--"),3)])),_:1}),a[24]||(a[24]=L()),B(fe,{prop:"statusDesc",label:"状态",align:"center"},{default:F((e=>[B(ve,{type:re(e.row.status)},{default:F((()=>[L(m(e.row.statusDesc),1)])),_:2},1032,["type"])])),_:1}),a[25]||(a[25]=L()),B(fe,{label:"操作",align:"center",width:"150"},{default:F((e=>[B(R,{type:"primary",link:"",size:"small",onClick:a=>me(e.row)},{default:F((()=>a[16]||(a[16]=[L("\r\n              详情\r\n            ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Ne,ee.value]]),a[26]||(a[26]=L()),ae.value>0?(S(),M(ge,{key:0,"page-sizes":[10,20,50,100],"page-size":Y.pageSize,currentPage:Y.pageNum,layout:"total, sizes, prev, pager, next, jumper",total:ae.value,onSizeChange:ce,onCurrentChange:ie},null,8,["page-size","currentPage","total"])):$("",!0)])),_:1}),a[42]||(a[42]=L()),B(ye,{modelValue:le.value,"onUpdate:modelValue":a[6]||(a[6]=e=>le.value=e),title:"成绩详情",width:"550px","append-to-body":""},{footer:F((()=>[O("div",K,[B(R,{onClick:a[5]||(a[5]=e=>le.value=!1)},{default:F((()=>a[38]||(a[38]=[L("关闭")]))),_:1})])])),default:F((()=>[B(he,{column:1,border:""},{default:F((()=>[B(_e,{label:"学生姓名"},{default:F((()=>[L(m(te.value.studentName),1)])),_:1}),a[27]||(a[27]=L()),B(_e,{label:"学号"},{default:F((()=>[L(m(te.value.studentNo),1)])),_:1}),a[28]||(a[28]=L()),B(_e,{label:"班级"},{default:F((()=>[L(m(te.value.className),1)])),_:1}),a[29]||(a[29]=L()),B(_e,{label:"课程名称"},{default:F((()=>[L(m(te.value.courseName),1)])),_:1}),a[30]||(a[30]=L()),B(_e,{label:"课程代码"},{default:F((()=>[L(m(te.value.courseCode),1)])),_:1}),a[31]||(a[31]=L()),B(_e,{label:"课程类型"},{default:F((()=>[L(m(te.value.courseType),1)])),_:1}),a[32]||(a[32]=L()),B(_e,{label:"学分"},{default:F((()=>[L(m(te.value.credits),1)])),_:1}),a[33]||(a[33]=L()),B(_e,{label:"学期"},{default:F((()=>[L(m(te.value.semester),1)])),_:1}),a[34]||(a[34]=L()),B(_e,{label:"教师"},{default:F((()=>[L(m(te.value.teacherName),1)])),_:1}),a[35]||(a[35]=L()),B(_e,{label:"成绩"},{default:F((()=>[O("span",{class:p(oe(te.value.score)),style:{"font-weight":"bold"}},m(null!==te.value.score?te.value.score.toFixed(1):"--"),3)])),_:1}),a[36]||(a[36]=L()),B(_e,{label:"选课时间"},{default:F((()=>[L(m(te.value.selectionTime),1)])),_:1}),a[37]||(a[37]=L()),B(_e,{label:"状态"},{default:F((()=>[B(ve,{type:re(te.value.status)},{default:F((()=>[L(m(te.value.statusDesc),1)])),_:1},8,["type"])])),_:1})])),_:1}),a[39]||(a[39]=L())])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-b8693edc"]]);export{X as default};
