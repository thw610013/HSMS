var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,u=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{s as o,_ as d,d as c,e as i}from"./index-1c6f2b30.js";import{M as n,r as p,ah as m,f,l as h,m as b,E as g,z as _,D as y,u as v,q as V,A as w,y as I,F as N,W as k}from"./vue-core-d6f028e5.js";import{M as O,R as j,B as C,m as U}from"./icons-02de347c.js";import{Q as q,O as z,P as x,aa as T,ab as P,R as S,ai as D,aj as R,ak as A,am as E,an as F,ao as M,ap as B,ae as Q,af as W,ac as $,ad as G,ag as H,aq as J,as as K}from"./element-plus-33c96ec5.js";import"./utils-80dc1c42.js";const L={class:"course-offering-container"},X={class:"card-header"},Y={class:"header-buttons"},Z={class:"pagination-container"},ee={class:"form-buttons"},ae=d({__name:"index",setup(e){const d=n({courseName:"",teacherName:"",semester:"",pageNum:1,pageSize:10}),ae=p([]),le=p(0),te=p(!1),re=p([]),se=p([]),ue=n({visible:!1,title:"新增课程开设",type:"add"}),oe=n({id:null,courseId:null,teacherId:null,semester:"",classTime:"",location:"",capacity:30,status:0}),de={courseId:[{required:!0,message:"请选择课程",trigger:"change"}],teacherId:[{required:!0,message:"请选择教师",trigger:"change"}],semester:[{required:!0,message:"请输入学期",trigger:"blur"}],classTime:[{required:!0,message:"请输入上课时间",trigger:"blur"}],location:[{required:!0,message:"请输入上课地点",trigger:"blur"}],capacity:[{required:!0,message:"请输入容量",trigger:"blur"}]},ce=p(null),ie=m();function ne(){var e;te.value=!0,(e=d,o({url:"/courseOffering/list",method:"get",params:e}).catch(e=>{throw e})).then(e=>{ae.value=e.data.list,le.value=e.data.total}).finally(()=>te.value=!1)}function pe(){d.pageNum=1,ne()}function me(){d.courseName="",d.teacherName="",d.semester="",pe()}function fe(e){d.pageSize=e,ne()}function he(e){d.pageNum=e,ne()}function be(e,a){ue.type=e,ue.title="add"===e?"新增课程开设":"编辑课程开设",ue.visible=!0,"edit"===e&&a?Object.assign(oe,a):Object.assign(oe,{id:null,courseId:null,teacherId:null,semester:"",classTime:"",location:"",capacity:30,status:0})}function ge(){ce.value.validate(e=>{if(!e)return;const d=(c=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&u(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&u(e,l,a[l]);return e})({},oe),i={courseId:Number(oe.courseId),teacherId:Number(oe.teacherId),capacity:Number(oe.capacity),status:Number(oe.status)},a(c,l(i)));var c,i,n;"add"===ue.type?(n=d,o({url:"/courseOffering",method:"post",data:n}).catch(e=>{throw e})).then(e=>{z.success("新增成功"),ue.visible=!1,ne()}).catch(e=>{z.error(e.message||"新增失败，请检查表单数据")}):function(e){return o({url:"/courseOffering",method:"put",data:e}).catch(e=>{throw e})}(d).then(e=>{z.success("修改成功"),ue.visible=!1,ne()}).catch(e=>{z.error(e.message||"修改失败，请检查表单数据")})})}function _e(e){x.confirm("确定要删除该课程开设记录吗？","提示",{type:"warning"}).then(()=>{var a;(a=e.id,o({url:`/courseOffering/${a}`,method:"delete"}).catch(e=>{throw e})).then(()=>{z.success("删除成功"),ne()})})}return f(()=>{ne(),c().then(e=>{200===e.code&&e.data&&e.data.list?re.value=e.data.list.map(e=>({id:e.id,name:e.name})):re.value=[]}).catch(e=>{re.value=[]}),i().then(e=>{200===e.code&&e.data&&e.data.list?se.value=e.data.list.map(e=>({id:e.id,name:e.name||(e.user?e.user.name:"未知教师")})):se.value=[]}).catch(e=>{se.value=[]})}),(e,a)=>{const l=T,t=P,r=S,s=D,u=R,o=A,c=E,i=F,n=M,p=B,m=Q,f=W,x=$,ne=G,ye=H,ve=J,Ve=K;return h(),b("div",L,[g(o,{class:"search-card",shadow:"hover"},{default:_(()=>[g(u,{model:d,ref:"queryForm",inline:!0},{default:_(()=>[g(t,{label:"课程名称",prop:"courseName"},{default:_(()=>[g(l,{modelValue:d.courseName,"onUpdate:modelValue":a[0]||(a[0]=e=>d.courseName=e),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])]),_:1}),a[18]||(a[18]=y()),g(t,{label:"教师名称",prop:"teacherName"},{default:_(()=>[g(l,{modelValue:d.teacherName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.teacherName=e),placeholder:"请输入教师名称",clearable:""},null,8,["modelValue"])]),_:1}),a[19]||(a[19]=y()),g(t,{label:"学期",prop:"semester"},{default:_(()=>[g(l,{modelValue:d.semester,"onUpdate:modelValue":a[2]||(a[2]=e=>d.semester=e),placeholder:"请输入学期",clearable:""},null,8,["modelValue"])]),_:1}),a[20]||(a[20]=y()),g(t,null,{default:_(()=>[g(s,{type:"primary",onClick:pe},{default:_(()=>[g(r,null,{default:_(()=>[g(v(O))]),_:1}),a[15]||(a[15]=y("查询\n          "))]),_:1}),a[17]||(a[17]=y()),g(s,{onClick:me},{default:_(()=>[g(r,null,{default:_(()=>[g(v(j))]),_:1}),a[16]||(a[16]=y("重置\n          "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a[51]||(a[51]=y()),g(o,{class:"table-card",shadow:"hover"},{header:_(()=>[V("div",X,[a[22]||(a[22]=V("span",{class:"header-title"},"课程开设记录",-1)),a[23]||(a[23]=y()),V("div",Y,[g(s,{type:"primary",onClick:a[3]||(a[3]=e=>be("add"))},{default:_(()=>[g(r,null,{default:_(()=>[g(v(C))]),_:1}),a[21]||(a[21]=y("新增\n            "))]),_:1})])])]),default:_(()=>[a[38]||(a[38]=y()),w((h(),I(n,{data:ae.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f5f7fa",color:"#606266"}},{default:_(()=>[g(c,{type:"index",label:"#",width:"60"}),a[29]||(a[29]=y()),g(c,{prop:"courseName",label:"课程名称",width:"160"}),a[30]||(a[30]=y()),g(c,{prop:"teacherName",label:"教师名称",width:"120"}),a[31]||(a[31]=y()),g(c,{prop:"semester",label:"学期",width:"120"}),a[32]||(a[32]=y()),g(c,{prop:"classTime",label:"上课时间",width:"120"}),a[33]||(a[33]=y()),g(c,{prop:"location",label:"上课地点",width:"120"}),a[34]||(a[34]=y()),g(c,{prop:"capacity",label:"容量",width:"80",align:"center"}),a[35]||(a[35]=y()),g(c,{prop:"selectedCount",label:"已选人数",width:"100",align:"center"}),a[36]||(a[36]=y()),g(c,{label:"状态",width:"100",align:"center"},{default:_(e=>[g(i,{type:0===e.row.status?"success":"info"},{default:_(()=>[y(q(0===e.row.status?"正常":"已结课"),1)]),_:2},1032,["type"])]),_:1}),a[37]||(a[37]=y()),g(c,{label:"操作","min-width":"220",fixed:"right"},{default:_(e=>[g(s,{type:"primary",link:"",onClick:a=>be("edit",e.row)},{default:_(()=>a[24]||(a[24]=[y("编辑")])),_:2},1032,["onClick"]),a[27]||(a[27]=y()),g(s,{type:"success",link:"",onClick:a=>function(e){try{z.info("正在跳转到考勤记录页面..."),ie.push({path:"/attendance-record",query:{courseId:e.courseId,courseOfferingId:e.id}}).catch(a=>{ie.push("/").then(()=>{setTimeout(()=>{ie.push({path:"/attendance-record",query:{courseId:e.courseId,courseOfferingId:e.id,_t:(new Date).getTime()}})},300)})})}catch(a){z.error("页面跳转发生错误，请联系管理员")}}(e.row)},{default:_(()=>[g(r,null,{default:_(()=>[g(v(U))]),_:1}),a[25]||(a[25]=y("考勤管理\n            "))]),_:2},1032,["onClick"]),a[28]||(a[28]=y()),g(s,{type:"danger",link:"",onClick:a=>_e(e.row)},{default:_(()=>a[26]||(a[26]=[y("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ve,te.value]]),a[39]||(a[39]=y()),V("div",Z,[g(p,{"current-page":d.pageNum,"onUpdate:currentPage":a[4]||(a[4]=e=>d.pageNum=e),"page-size":d.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>d.pageSize=e),"page-sizes":[10,20,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:le.value,onSizeChange:fe,onCurrentChange:he},null,8,["current-page","page-size","total"])])]),_:1}),a[52]||(a[52]=y()),g(ve,{title:ue.title,modelValue:ue.visible,"onUpdate:modelValue":a[14]||(a[14]=e=>ue.visible=e),width:"600px","append-to-body":"","destroy-on-close":""},{default:_(()=>[g(u,{ref_key:"formRef",ref:ce,model:oe,rules:de,"label-width":"100px"},{default:_(()=>[g(ye,{gutter:24},{default:_(()=>[g(x,{span:12},{default:_(()=>[g(t,{label:"课程",prop:"courseId"},{default:_(()=>[g(f,{modelValue:oe.courseId,"onUpdate:modelValue":a[6]||(a[6]=e=>oe.courseId=e),placeholder:"请选择课程",filterable:""},{default:_(()=>[(h(!0),b(N,null,k(re.value,e=>(h(),I(m,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a[41]||(a[41]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"教师",prop:"teacherId"},{default:_(()=>[g(f,{modelValue:oe.teacherId,"onUpdate:modelValue":a[7]||(a[7]=e=>oe.teacherId=e),placeholder:"请选择教师",filterable:""},{default:_(()=>[(h(!0),b(N,null,k(se.value,e=>(h(),I(m,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a[42]||(a[42]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"学期",prop:"semester"},{default:_(()=>[g(l,{modelValue:oe.semester,"onUpdate:modelValue":a[8]||(a[8]=e=>oe.semester=e),placeholder:"如 2023-2024-1"},null,8,["modelValue"])]),_:1})]),_:1}),a[43]||(a[43]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"上课时间",prop:"classTime"},{default:_(()=>[g(l,{modelValue:oe.classTime,"onUpdate:modelValue":a[9]||(a[9]=e=>oe.classTime=e),placeholder:"如 周一 1-2节"},null,8,["modelValue"])]),_:1})]),_:1}),a[44]||(a[44]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"上课地点",prop:"location"},{default:_(()=>[g(l,{modelValue:oe.location,"onUpdate:modelValue":a[10]||(a[10]=e=>oe.location=e),placeholder:"如 教学楼A-101"},null,8,["modelValue"])]),_:1})]),_:1}),a[45]||(a[45]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"容量",prop:"capacity"},{default:_(()=>[g(ne,{modelValue:oe.capacity,"onUpdate:modelValue":a[11]||(a[11]=e=>oe.capacity=e),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),a[46]||(a[46]=y()),g(x,{span:12},{default:_(()=>[g(t,{label:"状态",prop:"status"},{default:_(()=>[g(f,{modelValue:oe.status,"onUpdate:modelValue":a[12]||(a[12]=e=>oe.status=e),placeholder:"请选择状态"},{default:_(()=>[g(m,{label:"正常",value:0}),a[40]||(a[40]=y()),g(m,{label:"已结课",value:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a[50]||(a[50]=y()),V("div",ee,[g(s,{onClick:a[13]||(a[13]=e=>ue.visible=!1)},{default:_(()=>a[47]||(a[47]=[y("取消")])),_:1}),a[49]||(a[49]=y()),g(s,{type:"primary",onClick:ge},{default:_(()=>a[48]||(a[48]=[y("确定")])),_:1})])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},[["__scopeId","data-v-6a1f6c34"]]);export{ae as default};
