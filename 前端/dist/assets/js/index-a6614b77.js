import{w as e}from"./index-1c6f2b30.js";import{_ as a}from"./index-db7beee4.js";import{_ as l}from"./index-292e5414.js";import{r as o,c as t,f as d,l as u,m as n,E as i,z as r,q as s,D as p,A as c,G as m,X as v,F as f,W as h,y as g}from"./vue-core-d6f028e5.js";import{l as b,u as _,b as w,d as y}from"./major-fd7b9df7.js";import{O as V,P as x,aa as k,ab as j,af as C,ai as I,aj as U,ac as S,ag as q,am as z,ao as N,aq as D,ak as F,as as T,ae as E}from"./element-plus-33c96ec5.js";import"./icons-02de347c.js";import"./utils-80dc1c42.js";const P={class:"app-container"},B={class:"dialog-footer"},K={__name:"index",setup(K){const O=o(!1),R=o([]),A=t(()=>1!==R.value.length),G=t(()=>0===R.value.length),Q=o(!0),W=o(0),X=o([]),$=o(""),H=o(!1),J=o([]),L=o({pageNum:1,pageSize:10,name:void 0,code:void 0,departmentId:void 0}),M=o({id:void 0,name:void 0,code:void 0,departmentId:void 0,description:void 0}),Y={name:[{required:!0,message:"专业名称不能为空",trigger:"blur"}],code:[{required:!0,message:"专业编码不能为空",trigger:"blur"}],departmentId:[{required:!0,message:"所属院系不能为空",trigger:"change"}]},Z=o(null);function ee(){O.value=!0,b(L.value).then(e=>{200===e.code?(X.value=e.data.records||e.data,W.value=e.data.total||X.value.length):(V.error(e.msg||"获取专业列表失败"),X.value=[],W.value=0),O.value=!1}).catch(e=>{V.error("获取专业列表失败，请稍后重试"),O.value=!1})}function ae(){L.value.pageNum=1,ee()}function le(){L.value={pageNum:1,pageSize:10,name:void 0,code:void 0,departmentId:void 0},ae()}function oe(e){R.value=e.map(e=>e.id)}function te(){ie(),$.value="添加专业",H.value=!0}function de(e){ie();const a=e.id||R.value[0],l=X.value.find(e=>e.id===a);l&&(Object.assign(M.value,l),$.value="修改专业",H.value=!0)}function ue(){Z.value.validate(e=>{e&&(void 0!==M.value.id?_(M.value).then(e=>{200===e.code?(V.success("修改成功"),H.value=!1,ee()):V.error(e.msg||"修改失败")}).catch(e=>{V.error("修改失败，请稍后重试")}):w(M.value).then(e=>{200===e.code?(V.success("新增成功"),H.value=!1,ee()):V.error(e.msg||"新增失败")}).catch(e=>{V.error("新增失败，请稍后重试")}))})}function ne(e){const a=e.id||R.value,l=e.name||X.value.filter(e=>R.value.includes(e.id)).map(e=>e.name).join(",");x.confirm(`确认删除专业 ${l} 吗?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y(a).then(e=>{200===e.code?(V.success("删除成功"),ee()):V.error(e.msg||"删除失败")}).catch(e=>{V.error("删除失败，请稍后重试")})}).catch(()=>{})}function ie(){var e;M.value={id:void 0,name:void 0,code:void 0,departmentId:void 0,description:void 0},null==(e=Z.value)||e.resetFields()}function re(){H.value=!1,ie()}return d(()=>{e().then(e=>{200===e.code?J.value=e.data:V.error(e.msg||"获取院系列表失败")}).catch(e=>{V.error("获取院系列表失败，请稍后重试")}),ee()}),(e,o)=>{const t=k,d=j,b=E,_=C,w=I,y=U,V=S,x=l,K=q,R=z,ie=N,se=a,pe=D,ce=F,me=T;return u(),n("div",P,[i(ce,{class:"box-card"},{header:r(()=>o[11]||(o[11]=[s("div",{class:"card-header"},[s("span",null,"专业管理")],-1)])),default:r(()=>[o[41]||(o[41]=p()),c(i(y,{model:L.value,ref:"queryForm",inline:!0},{default:r(()=>[i(d,{label:"专业名称",prop:"name"},{default:r(()=>[i(t,{modelValue:L.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>L.value.name=e),placeholder:"请输入专业名称",clearable:"",style:{width:"240px"},onKeyup:v(ae,["enter"])},null,8,["modelValue"])]),_:1}),o[15]||(o[15]=p()),i(d,{label:"专业编码",prop:"code"},{default:r(()=>[i(t,{modelValue:L.value.code,"onUpdate:modelValue":o[1]||(o[1]=e=>L.value.code=e),placeholder:"请输入专业编码",clearable:"",style:{width:"240px"},onKeyup:v(ae,["enter"])},null,8,["modelValue"])]),_:1}),o[16]||(o[16]=p()),i(d,{label:"所属院系",prop:"departmentId"},{default:r(()=>[i(_,{modelValue:L.value.departmentId,"onUpdate:modelValue":o[2]||(o[2]=e=>L.value.departmentId=e),placeholder:"请选择所属院系",clearable:"",style:{width:"240px"}},{default:r(()=>[(u(!0),n(f,null,h(J.value,e=>(u(),g(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o[17]||(o[17]=p()),i(d,null,{default:r(()=>[i(w,{type:"primary",icon:"Search",onClick:ae},{default:r(()=>o[12]||(o[12]=[p("搜索")])),_:1}),o[14]||(o[14]=p()),i(w,{icon:"Refresh",onClick:le},{default:r(()=>o[13]||(o[13]=[p("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[m,Q.value]]),o[42]||(o[42]=p()),i(K,{gutter:10,class:"mb8"},{default:r(()=>[i(V,{span:1.5},{default:r(()=>[i(w,{type:"primary",plain:"",icon:"Plus",onClick:te},{default:r(()=>o[18]||(o[18]=[p("新增")])),_:1})]),_:1}),o[21]||(o[21]=p()),i(V,{span:1.5},{default:r(()=>[i(w,{type:"success",plain:"",icon:"Edit",disabled:A.value,onClick:de},{default:r(()=>o[19]||(o[19]=[p("修改")])),_:1},8,["disabled"])]),_:1}),o[22]||(o[22]=p()),i(V,{span:1.5},{default:r(()=>[i(w,{type:"danger",plain:"",icon:"Delete",disabled:G.value,onClick:ne},{default:r(()=>o[20]||(o[20]=[p("删除")])),_:1},8,["disabled"])]),_:1}),o[23]||(o[23]=p()),i(x,{showSearch:Q.value,"onUpdate:showSearch":o[3]||(o[3]=e=>Q.value=e),onQueryTable:ee},null,8,["showSearch"])]),_:1}),o[43]||(o[43]=p()),c((u(),g(ie,{data:X.value,onSelectionChange:oe},{default:r(()=>[i(R,{type:"selection",width:"55",align:"center"}),o[27]||(o[27]=p()),i(R,{label:"专业ID",align:"center",prop:"id",width:"80"}),o[28]||(o[28]=p()),i(R,{label:"专业名称",align:"center",prop:"name","show-overflow-tooltip":!0}),o[29]||(o[29]=p()),i(R,{label:"专业编码",align:"center",prop:"code","show-overflow-tooltip":!0}),o[30]||(o[30]=p()),i(R,{label:"所属院系",align:"center",prop:"departmentName","show-overflow-tooltip":!0}),o[31]||(o[31]=p()),i(R,{label:"描述",align:"center",prop:"description","show-overflow-tooltip":!0}),o[32]||(o[32]=p()),i(R,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),o[33]||(o[33]=p()),i(R,{label:"操作",align:"center",width:"180","class-name":"small-padding fixed-width"},{default:r(e=>[i(w,{type:"text",icon:"Edit",onClick:a=>de(e.row)},{default:r(()=>o[24]||(o[24]=[p("修改")])),_:2},1032,["onClick"]),o[26]||(o[26]=p()),i(w,{type:"text",icon:"Delete",onClick:a=>ne(e.row)},{default:r(()=>o[25]||(o[25]=[p("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,O.value]]),o[44]||(o[44]=p()),c(i(se,{total:W.value,page:L.value.pageNum,"onUpdate:page":o[4]||(o[4]=e=>L.value.pageNum=e),limit:L.value.pageSize,"onUpdate:limit":o[5]||(o[5]=e=>L.value.pageSize=e),onPagination:ee},null,8,["total","page","limit"]),[[m,W.value>0]]),o[45]||(o[45]=p()),i(pe,{title:$.value,modelValue:H.value,"onUpdate:modelValue":o[10]||(o[10]=e=>H.value=e),width:"600px","append-to-body":""},{footer:r(()=>[s("div",B,[i(w,{type:"primary",onClick:ue},{default:r(()=>o[37]||(o[37]=[p("确 定")])),_:1}),o[39]||(o[39]=p()),i(w,{onClick:re},{default:r(()=>o[38]||(o[38]=[p("取 消")])),_:1})])]),default:r(()=>[i(y,{ref_key:"majorFormRef",ref:Z,model:M.value,rules:Y,"label-width":"100px"},{default:r(()=>[i(d,{label:"专业名称",prop:"name"},{default:r(()=>[i(t,{modelValue:M.value.name,"onUpdate:modelValue":o[6]||(o[6]=e=>M.value.name=e),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1}),o[34]||(o[34]=p()),i(d,{label:"专业编码",prop:"code"},{default:r(()=>[i(t,{modelValue:M.value.code,"onUpdate:modelValue":o[7]||(o[7]=e=>M.value.code=e),placeholder:"请输入专业编码"},null,8,["modelValue"])]),_:1}),o[35]||(o[35]=p()),i(d,{label:"所属院系",prop:"departmentId"},{default:r(()=>[i(_,{modelValue:M.value.departmentId,"onUpdate:modelValue":o[8]||(o[8]=e=>M.value.departmentId=e),placeholder:"请选择所属院系",style:{width:"100%"}},{default:r(()=>[(u(!0),n(f,null,h(J.value,e=>(u(),g(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o[36]||(o[36]=p()),i(d,{label:"描述",prop:"description"},{default:r(()=>[i(t,{modelValue:M.value.description,"onUpdate:modelValue":o[9]||(o[9]=e=>M.value.description=e),type:"textarea",placeholder:"请输入专业描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),o[40]||(o[40]=p())]),_:1},8,["title","modelValue"])]),_:1})])}}};export{K as default};
