import{p as e,q as a,r as l,t as o,v as t}from"./index-c00447c9.js";import{_ as n}from"./index-f992b0ab.js";import{_ as u}from"./index-aa3c308e.js";import{r as d,c as r,k as i,z as c,P as s,H as p,aq as m,y as v,A as f,L as h,I as g,Q as _,a5 as b,G as w}from"./vue-core-ad22061d.js";import{E as y,u as x,a as V,w as k,x as C,F as S,G as U,y as j,C as z,J as N,L as q,H as P,O as F}from"./element-plus-7067fc91.js";import"./icons-3f8828dd.js";import"./utils-ebe9136b.js";const T={class:"app-container"},D={class:"dialog-footer"},E={__name:"index",setup(E){const B=d(!1),G=d([]),H=r(()=>1!==G.value.length),I=r(()=>0===G.value.length),K=d(!0),L=d(0),O=d([]),Q=d(""),A=d(!1),J=d({pageNum:1,pageSize:10,name:void 0,code:void 0}),R=d({id:void 0,name:void 0,code:void 0,description:void 0}),M={name:[{required:!0,message:"院系名称不能为空",trigger:"blur"}],code:[{required:!0,message:"院系编码不能为空",trigger:"blur"}]},W=d(null);function X(){B.value=!0,e({pageNum:J.value.pageNum,pageSize:J.value.pageSize,name:J.value.name,code:J.value.code}).then(e=>{O.value=e.data.records||[],L.value=e.data.total||0,B.value=!1}).catch(e=>{console.error("获取院系列表失败:",e),B.value=!1,y.error("获取院系列表失败")})}function Y(){J.value.pageNum=1,X()}function Z(){J.value={pageNum:1,pageSize:10,name:void 0,code:void 0},Y()}function $(e){G.value=e.map(e=>e.id)}function ee(){te(),Q.value="添加院系",A.value=!0}function ae(e){te();const l=e.id||G.value[0];B.value=!0,a(l).then(e=>{B.value=!1,e.data?(Object.assign(R.value,e.data),Q.value="修改院系",A.value=!0):y.warning("获取院系详情失败")}).catch(e=>{console.error("获取院系详情失败:",e),B.value=!1,y.error("获取院系详情失败")})}function le(){var e;null==(e=W.value)||e.validate(e=>{e&&(R.value.id?l(R.value).then(e=>{y.success("修改成功"),A.value=!1,X()}).catch(e=>{console.error("修改院系失败:",e),y.error("修改院系失败")}):o(R.value).then(e=>{y.success("新增成功"),A.value=!1,X()}).catch(e=>{console.error("新增院系失败:",e),y.error("新增院系失败")}))})}function oe(e){const a=e.id||G.value;V.confirm("确认删除选中的院系信息?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{if("number"==typeof a)t(a).then(e=>{y.success("删除成功"),X()}).catch(e=>{console.error("删除院系失败:",e),y.error("删除院系失败")});else{const e=a.map(e=>t(e));Promise.all(e).then(()=>{y.success("批量删除成功"),X()}).catch(e=>{console.error("批量删除院系失败:",e),y.error("批量删除院系失败")})}}).catch(()=>{})}function te(){var e;R.value={id:void 0,name:void 0,code:void 0,description:void 0},null==(e=W.value)||e.resetFields()}function ne(){A.value=!1,te()}return i(()=>{X()}),(e,a)=>{const l=k,o=C,t=S,d=U,r=j,i=u,y=z,V=N,E=q,G=n,te=P,ue=x,de=m("hasPermi"),re=F;return v(),c("div",T,[s(ue,{class:"box-card"},{header:p(()=>a[9]||(a[9]=[f("div",{class:"card-header"},[f("span",null,"院系管理")],-1)])),default:p(()=>[a[36]||(a[36]=h()),g(s(d,{model:J.value,ref:"queryForm",inline:!0},{default:p(()=>[s(o,{label:"院系名称",prop:"name"},{default:p(()=>[s(l,{modelValue:J.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>J.value.name=e),placeholder:"请输入院系名称",clearable:"",style:{width:"240px"},onKeyup:b(Y,["enter"])},null,8,["modelValue"])]),_:1}),a[13]||(a[13]=h()),s(o,{label:"院系编码",prop:"code"},{default:p(()=>[s(l,{modelValue:J.value.code,"onUpdate:modelValue":a[1]||(a[1]=e=>J.value.code=e),placeholder:"请输入院系编码",clearable:"",style:{width:"240px"},onKeyup:b(Y,["enter"])},null,8,["modelValue"])]),_:1}),a[14]||(a[14]=h()),s(o,null,{default:p(()=>[s(t,{type:"primary",icon:"Search",onClick:Y},{default:p(()=>a[10]||(a[10]=[h("搜索")])),_:1}),a[12]||(a[12]=h()),s(t,{icon:"Refresh",onClick:Z},{default:p(()=>a[11]||(a[11]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[_,K.value]]),a[37]||(a[37]=h()),s(y,{gutter:10,class:"mb8"},{default:p(()=>[s(r,{span:1.5},{default:p(()=>[g((v(),w(t,{type:"primary",plain:"",icon:"Plus",onClick:ee},{default:p(()=>a[15]||(a[15]=[h("新增")])),_:1})),[[de,["education:department:add"]]])]),_:1}),a[18]||(a[18]=h()),s(r,{span:1.5},{default:p(()=>[g((v(),w(t,{type:"success",plain:"",icon:"Edit",disabled:H.value,onClick:ae},{default:p(()=>a[16]||(a[16]=[h("修改")])),_:1},8,["disabled"])),[[de,["education:department:edit"]]])]),_:1}),a[19]||(a[19]=h()),s(r,{span:1.5},{default:p(()=>[g((v(),w(t,{type:"danger",plain:"",icon:"Delete",disabled:I.value,onClick:oe},{default:p(()=>a[17]||(a[17]=[h("删除")])),_:1},8,["disabled"])),[[de,["education:department:remove"]]])]),_:1}),a[20]||(a[20]=h()),s(i,{showSearch:K.value,"onUpdate:showSearch":a[2]||(a[2]=e=>K.value=e),onQueryTable:X},null,8,["showSearch"])]),_:1}),a[38]||(a[38]=h()),g((v(),w(E,{data:O.value,onSelectionChange:$},{default:p(()=>[s(V,{type:"selection",width:"55",align:"center"}),a[24]||(a[24]=h()),s(V,{label:"院系ID",align:"center",prop:"id",width:"80"}),a[25]||(a[25]=h()),s(V,{label:"院系名称",align:"center",prop:"name","show-overflow-tooltip":!0}),a[26]||(a[26]=h()),s(V,{label:"院系编码",align:"center",prop:"code","show-overflow-tooltip":!0}),a[27]||(a[27]=h()),s(V,{label:"描述",align:"center",prop:"description","show-overflow-tooltip":!0}),a[28]||(a[28]=h()),s(V,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),a[29]||(a[29]=h()),s(V,{label:"操作",align:"center",width:"180","class-name":"small-padding fixed-width"},{default:p(e=>[g((v(),w(t,{type:"text",icon:"Edit",onClick:a=>ae(e.row)},{default:p(()=>a[21]||(a[21]=[h("修改")])),_:2},1032,["onClick"])),[[de,["education:department:edit"]]]),a[23]||(a[23]=h()),g((v(),w(t,{type:"text",icon:"Delete",onClick:a=>oe(e.row)},{default:p(()=>a[22]||(a[22]=[h("删除")])),_:2},1032,["onClick"])),[[de,["education:department:remove"]]])]),_:1})]),_:1},8,["data"])),[[re,B.value]]),a[39]||(a[39]=h()),g(s(G,{total:L.value,page:J.value.pageNum,"onUpdate:page":a[3]||(a[3]=e=>J.value.pageNum=e),limit:J.value.pageSize,"onUpdate:limit":a[4]||(a[4]=e=>J.value.pageSize=e),onPagination:X},null,8,["total","page","limit"]),[[_,L.value>0]]),a[40]||(a[40]=h()),s(te,{title:Q.value,modelValue:A.value,"onUpdate:modelValue":a[8]||(a[8]=e=>A.value=e),width:"600px","append-to-body":""},{footer:p(()=>[f("div",D,[s(t,{type:"primary",onClick:le},{default:p(()=>a[32]||(a[32]=[h("确 定")])),_:1}),a[34]||(a[34]=h()),s(t,{onClick:ne},{default:p(()=>a[33]||(a[33]=[h("取 消")])),_:1})])]),default:p(()=>[s(d,{ref_key:"departmentForm",ref:W,model:R.value,rules:M,"label-width":"100px"},{default:p(()=>[s(o,{label:"院系名称",prop:"name"},{default:p(()=>[s(l,{modelValue:R.value.name,"onUpdate:modelValue":a[5]||(a[5]=e=>R.value.name=e),placeholder:"请输入院系名称"},null,8,["modelValue"])]),_:1}),a[30]||(a[30]=h()),s(o,{label:"院系编码",prop:"code"},{default:p(()=>[s(l,{modelValue:R.value.code,"onUpdate:modelValue":a[6]||(a[6]=e=>R.value.code=e),placeholder:"请输入院系编码"},null,8,["modelValue"])]),_:1}),a[31]||(a[31]=h()),s(o,{label:"描述",prop:"description"},{default:p(()=>[s(l,{modelValue:R.value.description,"onUpdate:modelValue":a[7]||(a[7]=e=>R.value.description=e),type:"textarea",placeholder:"请输入院系描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a[35]||(a[35]=h())]),_:1},8,["title","modelValue"])]),_:1})])}}};export{E as default};
