import{w as e}from"./index-c00447c9.js";import{_ as a}from"./index-f992b0ab.js";import{_ as l}from"./index-aa3c308e.js";import{r as o,c as t,k as d,z as u,P as n,H as r,y as i,A as s,L as c,I as p,Q as m,a5 as v,O as f,a4 as h,G as g}from"./vue-core-ad22061d.js";import{l as b,u as _,b as w,d as y}from"./major-11c16f9b.js";import{E as V,u as x,a as k,w as C,x as I,B as j,F as U,G as S,y as z,C as N,J as q,L as F,H as T,O as B,A as D}from"./element-plus-7067fc91.js";import"./icons-3f8828dd.js";import"./utils-ebe9136b.js";const E={class:"app-container"},O={class:"dialog-footer"},P={__name:"index",setup(P){const A=o(!1),G=o([]),H=t(()=>1!==G.value.length),K=t(()=>0===G.value.length),L=o(!0),Q=o(0),R=o([]),J=o(""),$=o(!1),M=o([]),W=o({pageNum:1,pageSize:10,name:void 0,code:void 0,departmentId:void 0}),X=o({id:void 0,name:void 0,code:void 0,departmentId:void 0,description:void 0}),Y={name:[{required:!0,message:"专业名称不能为空",trigger:"blur"}],code:[{required:!0,message:"专业编码不能为空",trigger:"blur"}],departmentId:[{required:!0,message:"所属院系不能为空",trigger:"change"}]},Z=o(null);function ee(){A.value=!0,b(W.value).then(e=>{200===e.code?(R.value=e.data.records||e.data,Q.value=e.data.total||R.value.length):(V.error(e.msg||"获取专业列表失败"),R.value=[],Q.value=0),A.value=!1}).catch(e=>{console.error("获取专业列表失败:",e),V.error("获取专业列表失败，请稍后重试"),A.value=!1})}function ae(){W.value.pageNum=1,ee()}function le(){W.value={pageNum:1,pageSize:10,name:void 0,code:void 0,departmentId:void 0},ae()}function oe(e){G.value=e.map(e=>e.id)}function te(){re(),J.value="添加专业",$.value=!0}function de(e){re();const a=e.id||G.value[0],l=R.value.find(e=>e.id===a);l&&(Object.assign(X.value,l),J.value="修改专业",$.value=!0)}function ue(){Z.value.validate(e=>{e&&(void 0!==X.value.id?_(X.value).then(e=>{200===e.code?(V.success("修改成功"),$.value=!1,ee()):V.error(e.msg||"修改失败")}).catch(e=>{console.error("修改专业失败:",e),V.error("修改失败，请稍后重试")}):w(X.value).then(e=>{200===e.code?(V.success("新增成功"),$.value=!1,ee()):V.error(e.msg||"新增失败")}).catch(e=>{console.error("新增专业失败:",e),V.error("新增失败，请稍后重试")}))})}function ne(e){const a=e.id||G.value,l=e.name||R.value.filter(e=>G.value.includes(e.id)).map(e=>e.name).join(",");k.confirm(`确认删除专业 ${l} 吗?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y(a).then(e=>{200===e.code?(V.success("删除成功"),ee()):V.error(e.msg||"删除失败")}).catch(e=>{console.error("删除专业失败:",e),V.error("删除失败，请稍后重试")})}).catch(()=>{})}function re(){var e;X.value={id:void 0,name:void 0,code:void 0,departmentId:void 0,description:void 0},null==(e=Z.value)||e.resetFields()}function ie(){$.value=!1,re()}return d(()=>{e().then(e=>{200===e.code?M.value=e.data:V.error(e.msg||"获取院系列表失败")}).catch(e=>{console.error("获取院系列表失败:",e),V.error("获取院系列表失败，请稍后重试")}),ee()}),(e,o)=>{const t=C,d=I,b=D,_=j,w=U,y=S,V=z,k=l,P=N,G=q,re=F,se=a,ce=T,pe=x,me=B;return i(),u("div",E,[n(pe,{class:"box-card"},{header:r(()=>o[11]||(o[11]=[s("div",{class:"card-header"},[s("span",null,"专业管理")],-1)])),default:r(()=>[o[41]||(o[41]=c()),p(n(y,{model:W.value,ref:"queryForm",inline:!0},{default:r(()=>[n(d,{label:"专业名称",prop:"name"},{default:r(()=>[n(t,{modelValue:W.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>W.value.name=e),placeholder:"请输入专业名称",clearable:"",style:{width:"240px"},onKeyup:v(ae,["enter"])},null,8,["modelValue"])]),_:1}),o[15]||(o[15]=c()),n(d,{label:"专业编码",prop:"code"},{default:r(()=>[n(t,{modelValue:W.value.code,"onUpdate:modelValue":o[1]||(o[1]=e=>W.value.code=e),placeholder:"请输入专业编码",clearable:"",style:{width:"240px"},onKeyup:v(ae,["enter"])},null,8,["modelValue"])]),_:1}),o[16]||(o[16]=c()),n(d,{label:"所属院系",prop:"departmentId"},{default:r(()=>[n(_,{modelValue:W.value.departmentId,"onUpdate:modelValue":o[2]||(o[2]=e=>W.value.departmentId=e),placeholder:"请选择所属院系",clearable:"",style:{width:"240px"}},{default:r(()=>[(i(!0),u(f,null,h(M.value,e=>(i(),g(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o[17]||(o[17]=c()),n(d,null,{default:r(()=>[n(w,{type:"primary",icon:"Search",onClick:ae},{default:r(()=>o[12]||(o[12]=[c("搜索")])),_:1}),o[14]||(o[14]=c()),n(w,{icon:"Refresh",onClick:le},{default:r(()=>o[13]||(o[13]=[c("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[m,L.value]]),o[42]||(o[42]=c()),n(P,{gutter:10,class:"mb8"},{default:r(()=>[n(V,{span:1.5},{default:r(()=>[n(w,{type:"primary",plain:"",icon:"Plus",onClick:te},{default:r(()=>o[18]||(o[18]=[c("新增")])),_:1})]),_:1}),o[21]||(o[21]=c()),n(V,{span:1.5},{default:r(()=>[n(w,{type:"success",plain:"",icon:"Edit",disabled:H.value,onClick:de},{default:r(()=>o[19]||(o[19]=[c("修改")])),_:1},8,["disabled"])]),_:1}),o[22]||(o[22]=c()),n(V,{span:1.5},{default:r(()=>[n(w,{type:"danger",plain:"",icon:"Delete",disabled:K.value,onClick:ne},{default:r(()=>o[20]||(o[20]=[c("删除")])),_:1},8,["disabled"])]),_:1}),o[23]||(o[23]=c()),n(k,{showSearch:L.value,"onUpdate:showSearch":o[3]||(o[3]=e=>L.value=e),onQueryTable:ee},null,8,["showSearch"])]),_:1}),o[43]||(o[43]=c()),p((i(),g(re,{data:R.value,onSelectionChange:oe},{default:r(()=>[n(G,{type:"selection",width:"55",align:"center"}),o[27]||(o[27]=c()),n(G,{label:"专业ID",align:"center",prop:"id",width:"80"}),o[28]||(o[28]=c()),n(G,{label:"专业名称",align:"center",prop:"name","show-overflow-tooltip":!0}),o[29]||(o[29]=c()),n(G,{label:"专业编码",align:"center",prop:"code","show-overflow-tooltip":!0}),o[30]||(o[30]=c()),n(G,{label:"所属院系",align:"center",prop:"departmentName","show-overflow-tooltip":!0}),o[31]||(o[31]=c()),n(G,{label:"描述",align:"center",prop:"description","show-overflow-tooltip":!0}),o[32]||(o[32]=c()),n(G,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),o[33]||(o[33]=c()),n(G,{label:"操作",align:"center",width:"180","class-name":"small-padding fixed-width"},{default:r(e=>[n(w,{type:"text",icon:"Edit",onClick:a=>de(e.row)},{default:r(()=>o[24]||(o[24]=[c("修改")])),_:2},1032,["onClick"]),o[26]||(o[26]=c()),n(w,{type:"text",icon:"Delete",onClick:a=>ne(e.row)},{default:r(()=>o[25]||(o[25]=[c("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,A.value]]),o[44]||(o[44]=c()),p(n(se,{total:Q.value,page:W.value.pageNum,"onUpdate:page":o[4]||(o[4]=e=>W.value.pageNum=e),limit:W.value.pageSize,"onUpdate:limit":o[5]||(o[5]=e=>W.value.pageSize=e),onPagination:ee},null,8,["total","page","limit"]),[[m,Q.value>0]]),o[45]||(o[45]=c()),n(ce,{title:J.value,modelValue:$.value,"onUpdate:modelValue":o[10]||(o[10]=e=>$.value=e),width:"600px","append-to-body":""},{footer:r(()=>[s("div",O,[n(w,{type:"primary",onClick:ue},{default:r(()=>o[37]||(o[37]=[c("确 定")])),_:1}),o[39]||(o[39]=c()),n(w,{onClick:ie},{default:r(()=>o[38]||(o[38]=[c("取 消")])),_:1})])]),default:r(()=>[n(y,{ref_key:"majorFormRef",ref:Z,model:X.value,rules:Y,"label-width":"100px"},{default:r(()=>[n(d,{label:"专业名称",prop:"name"},{default:r(()=>[n(t,{modelValue:X.value.name,"onUpdate:modelValue":o[6]||(o[6]=e=>X.value.name=e),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1}),o[34]||(o[34]=c()),n(d,{label:"专业编码",prop:"code"},{default:r(()=>[n(t,{modelValue:X.value.code,"onUpdate:modelValue":o[7]||(o[7]=e=>X.value.code=e),placeholder:"请输入专业编码"},null,8,["modelValue"])]),_:1}),o[35]||(o[35]=c()),n(d,{label:"所属院系",prop:"departmentId"},{default:r(()=>[n(_,{modelValue:X.value.departmentId,"onUpdate:modelValue":o[8]||(o[8]=e=>X.value.departmentId=e),placeholder:"请选择所属院系",style:{width:"100%"}},{default:r(()=>[(i(!0),u(f,null,h(M.value,e=>(i(),g(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o[36]||(o[36]=c()),n(d,{label:"描述",prop:"description"},{default:r(()=>[n(t,{modelValue:X.value.description,"onUpdate:modelValue":o[9]||(o[9]=e=>X.value.description=e),type:"textarea",placeholder:"请输入专业描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),o[40]||(o[40]=c())]),_:1},8,["title","modelValue"])]),_:1})])}}};export{P as default};
